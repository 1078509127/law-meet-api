{"remainingRequest":"D:\\Projects\\java\\law-meet-api\\law-meet-vue\\node_modules\\@vue\\cli-plugin-babel\\node_modules\\babel-loader\\lib\\index.js!D:\\Projects\\java\\law-meet-api\\law-meet-vue\\node_modules\\@vue\\cli-plugin-eslint\\node_modules\\eslint-loader\\index.js??ref--13-0!D:\\Projects\\java\\law-meet-api\\law-meet-vue\\src\\store\\modules\\permission.js","dependencies":[{"path":"D:\\Projects\\java\\law-meet-api\\law-meet-vue\\src\\store\\modules\\permission.js","mtime":1720695645761},{"path":"D:\\Projects\\java\\law-meet-api\\law-meet-vue\\babel.config.js","mtime":1720695645901},{"path":"D:\\Projects\\java\\law-meet-api\\law-meet-vue\\node_modules\\cache-loader\\dist\\cjs.js","mtime":1720774706922},{"path":"D:\\Projects\\java\\law-meet-api\\law-meet-vue\\node_modules\\@vue\\cli-plugin-babel\\node_modules\\babel-loader\\lib\\index.js","mtime":1720774708117},{"path":"D:\\Projects\\java\\law-meet-api\\law-meet-vue\\node_modules\\@vue\\cli-plugin-eslint\\node_modules\\eslint-loader\\index.js","mtime":1720774707220}],"contextDependencies":[],"result":[{"type":"Buffer","data":"base64:InVzZSBzdHJpY3QiOwoKdmFyIF9pbnRlcm9wUmVxdWlyZURlZmF1bHQgPSByZXF1aXJlKCJEOi9Qcm9qZWN0cy9qYXZhL2xhdy1tZWV0LWFwaS9sYXctbWVldC12dWUvbm9kZV9tb2R1bGVzL0BiYWJlbC9ydW50aW1lL2hlbHBlcnMvaW50ZXJvcFJlcXVpcmVEZWZhdWx0LmpzIikuZGVmYXVsdDsKT2JqZWN0LmRlZmluZVByb3BlcnR5KGV4cG9ydHMsICJfX2VzTW9kdWxlIiwgewogIHZhbHVlOiB0cnVlCn0pOwpleHBvcnRzLmRlZmF1bHQgPSB2b2lkIDA7CnZhciBfb2JqZWN0U3ByZWFkMiA9IF9pbnRlcm9wUmVxdWlyZURlZmF1bHQocmVxdWlyZSgiRDovUHJvamVjdHMvamF2YS9sYXctbWVldC1hcGkvbGF3LW1lZXQtdnVlL25vZGVfbW9kdWxlcy9AYmFiZWwvcnVudGltZS9oZWxwZXJzL29iamVjdFNwcmVhZDIuanMiKSk7CnJlcXVpcmUoImNvcmUtanMvbW9kdWxlcy9lcy5hcnJheS5jb25jYXQuanMiKTsKcmVxdWlyZSgiY29yZS1qcy9tb2R1bGVzL2VzLmFycmF5LmluY2x1ZGVzLmpzIik7CnJlcXVpcmUoImNvcmUtanMvbW9kdWxlcy9lcy5hcnJheS5wdXNoLmpzIik7CnJlcXVpcmUoImNvcmUtanMvbW9kdWxlcy9lcy5vYmplY3QudG8tc3RyaW5nLmpzIik7CnJlcXVpcmUoImNvcmUtanMvbW9kdWxlcy9lcy5zdHJpbmcuaW5jbHVkZXMuanMiKTsKcmVxdWlyZSgiY29yZS1qcy9tb2R1bGVzL3dlYi5kb20tY29sbGVjdGlvbnMuZm9yLWVhY2guanMiKTsKdmFyIF9yb3V0ZXIgPSByZXF1aXJlKCJAL3JvdXRlciIpOwovKioNCiAqIOmAmui/h21ldGEucGVybXPliKTmlq3mmK/lkKbkuI7lvZPliY3nlKjmiLfmnYPpmZDljLnphY0NCiAqIEBwYXJhbSBwZXJtcw0KICogQHBhcmFtIHJvdXRlDQogKi8KZnVuY3Rpb24gaGFzUGVybWlzc2lvbihwZXJtcywgcm91dGUpIHsKICBpZiAocm91dGUubWV0YSAmJiByb3V0ZS5tZXRhLnBlcm1zKSB7CiAgICByZXR1cm4gcGVybXMuc29tZShmdW5jdGlvbiAocGVybSkgewogICAgICByZXR1cm4gcm91dGUubWV0YS5wZXJtcy5pbmNsdWRlcyhwZXJtKTsKICAgIH0pOwogIH0gZWxzZSB7CiAgICByZXR1cm4gdHJ1ZTsKICB9Cn0KCi8qKg0KICog6YCS5b2S6L+H5ruk5byC5q2l6Lev55Sx6KGo77yM6L+U5Zue56ym5ZCI55So5oi36KeS6Imy5p2D6ZmQ55qE6Lev55Sx6KGoDQogKiBAcGFyYW0gcm91dGVzIGFzeW5jUm91dGVyTWFwDQogKiBAcGFyYW0gcGVybXMNCiAqLwpmdW5jdGlvbiBmaWx0ZXJBc3luY1JvdXRlcihyb3V0ZXMsIHBlcm1zKSB7CiAgdmFyIHJlcyA9IFtdOwogIHJvdXRlcy5mb3JFYWNoKGZ1bmN0aW9uIChyb3V0ZSkgewogICAgdmFyIHRtcCA9ICgwLCBfb2JqZWN0U3ByZWFkMi5kZWZhdWx0KSh7fSwgcm91dGUpOwogICAgaWYgKHRtcC5jaGlsZHJlbikgewogICAgICB0bXAuY2hpbGRyZW4gPSBmaWx0ZXJBc3luY1JvdXRlcih0bXAuY2hpbGRyZW4sIHBlcm1zKTsKICAgICAgaWYgKHRtcC5jaGlsZHJlbiAmJiB0bXAuY2hpbGRyZW4ubGVuZ3RoID4gMCkgewogICAgICAgIHJlcy5wdXNoKHRtcCk7CiAgICAgIH0KICAgIH0gZWxzZSB7CiAgICAgIGlmIChoYXNQZXJtaXNzaW9uKHBlcm1zLCB0bXApKSB7CiAgICAgICAgcmVzLnB1c2godG1wKTsKICAgICAgfQogICAgfQogIH0pOwogIHJldHVybiByZXM7Cn0KdmFyIHBlcm1pc3Npb24gPSB7CiAgc3RhdGU6IHsKICAgIHJvdXRlcnM6IF9yb3V0ZXIuY29uc3RhbnRSb3V0ZXJNYXAsCiAgICBhZGRSb3V0ZXJzOiBbXQogIH0sCiAgbXV0YXRpb25zOiB7CiAgICBTRVRfUk9VVEVSUzogZnVuY3Rpb24gU0VUX1JPVVRFUlMoc3RhdGUsIHJvdXRlcnMpIHsKICAgICAgc3RhdGUuYWRkUm91dGVycyA9IHJvdXRlcnM7CiAgICAgIHN0YXRlLnJvdXRlcnMgPSBfcm91dGVyLmNvbnN0YW50Um91dGVyTWFwLmNvbmNhdChyb3V0ZXJzKTsKICAgIH0KICB9LAogIGFjdGlvbnM6IHsKICAgIEdlbmVyYXRlUm91dGVzOiBmdW5jdGlvbiBHZW5lcmF0ZVJvdXRlcyhfcmVmLCBkYXRhKSB7CiAgICAgIHZhciBjb21taXQgPSBfcmVmLmNvbW1pdDsKICAgICAgcmV0dXJuIG5ldyBQcm9taXNlKGZ1bmN0aW9uIChyZXNvbHZlKSB7CiAgICAgICAgdmFyIHBlcm1zID0gZGF0YS5wZXJtczsKICAgICAgICB2YXIgYWNjZXNzZWRSb3V0ZXJzOwogICAgICAgIGlmIChwZXJtcy5pbmNsdWRlcygnKicpKSB7CiAgICAgICAgICBhY2Nlc3NlZFJvdXRlcnMgPSBfcm91dGVyLmFzeW5jUm91dGVyTWFwOwogICAgICAgIH0gZWxzZSB7CiAgICAgICAgICBhY2Nlc3NlZFJvdXRlcnMgPSBmaWx0ZXJBc3luY1JvdXRlcihfcm91dGVyLmFzeW5jUm91dGVyTWFwLCBwZXJtcyk7CiAgICAgICAgfQogICAgICAgIGNvbW1pdCgnU0VUX1JPVVRFUlMnLCBhY2Nlc3NlZFJvdXRlcnMpOwogICAgICAgIHJlc29sdmUoKTsKICAgICAgfSk7CiAgICB9CiAgfQp9Owp2YXIgX2RlZmF1bHQgPSBleHBvcnRzLmRlZmF1bHQgPSBwZXJtaXNzaW9uOw=="},{"version":3,"names":["_router","require","hasPermission","perms","route","meta","some","perm","includes","filterAsyncRouter","routes","res","forEach","tmp","_objectSpread2","default","children","length","push","permission","state","routers","constantRouterMap","addRouters","mutations","SET_ROUTERS","concat","actions","GenerateRoutes","_ref","data","commit","Promise","resolve","accessedRouters","asyncRouterMap","_default","exports"],"sources":["D:/Projects/java/law-meet-api/law-meet-vue/src/store/modules/permission.js"],"sourcesContent":["import { asyncRouterMap, constantRouterMap } from '@/router'\r\n\r\n/**\r\n * 通过meta.perms判断是否与当前用户权限匹配\r\n * @param perms\r\n * @param route\r\n */\r\nfunction hasPermission(perms, route) {\r\n  if (route.meta && route.meta.perms) {\r\n    return perms.some(perm => route.meta.perms.includes(perm))\r\n  } else {\r\n    return true\r\n  }\r\n}\r\n\r\n/**\r\n * 递归过滤异步路由表，返回符合用户角色权限的路由表\r\n * @param routes asyncRouterMap\r\n * @param perms\r\n */\r\nfunction filterAsyncRouter(routes, perms) {\r\n  const res = []\r\n\r\n  routes.forEach(route => {\r\n    const tmp = { ...route }\r\n    if (tmp.children) {\r\n      tmp.children = filterAsyncRouter(tmp.children, perms)\r\n      if (tmp.children && tmp.children.length > 0) {\r\n        res.push(tmp)\r\n      }\r\n    } else {\r\n      if (hasPermission(perms, tmp)) {\r\n        res.push(tmp)\r\n      }\r\n    }\r\n  })\r\n\r\n  return res\r\n}\r\n\r\nconst permission = {\r\n  state: {\r\n    routers: constantRouterMap,\r\n    addRouters: []\r\n  },\r\n  mutations: {\r\n    SET_ROUTERS: (state, routers) => {\r\n      state.addRouters = routers\r\n      state.routers = constantRouterMap.concat(routers)\r\n    }\r\n  },\r\n  actions: {\r\n    GenerateRoutes({ commit }, data) {\r\n      return new Promise(resolve => {\r\n        const { perms } = data\r\n        let accessedRouters\r\n        if (perms.includes('*')) {\r\n          accessedRouters = asyncRouterMap\r\n        } else {\r\n          accessedRouters = filterAsyncRouter(asyncRouterMap, perms)\r\n        }\r\n        commit('SET_ROUTERS', accessedRouters)\r\n        resolve()\r\n      })\r\n    }\r\n  }\r\n}\r\n\r\nexport default permission\r\n"],"mappings":";;;;;;;;;;;;;;AAAA,IAAAA,OAAA,GAAAC,OAAA;AAEA;AACA;AACA;AACA;AACA;AACA,SAASC,aAAaA,CAACC,KAAK,EAAEC,KAAK,EAAE;EACnC,IAAIA,KAAK,CAACC,IAAI,IAAID,KAAK,CAACC,IAAI,CAACF,KAAK,EAAE;IAClC,OAAOA,KAAK,CAACG,IAAI,CAAC,UAAAC,IAAI;MAAA,OAAIH,KAAK,CAACC,IAAI,CAACF,KAAK,CAACK,QAAQ,CAACD,IAAI,CAAC;IAAA,EAAC;EAC5D,CAAC,MAAM;IACL,OAAO,IAAI;EACb;AACF;;AAEA;AACA;AACA;AACA;AACA;AACA,SAASE,iBAAiBA,CAACC,MAAM,EAAEP,KAAK,EAAE;EACxC,IAAMQ,GAAG,GAAG,EAAE;EAEdD,MAAM,CAACE,OAAO,CAAC,UAAAR,KAAK,EAAI;IACtB,IAAMS,GAAG,OAAAC,cAAA,CAAAC,OAAA,MAAQX,KAAK,CAAE;IACxB,IAAIS,GAAG,CAACG,QAAQ,EAAE;MAChBH,GAAG,CAACG,QAAQ,GAAGP,iBAAiB,CAACI,GAAG,CAACG,QAAQ,EAAEb,KAAK,CAAC;MACrD,IAAIU,GAAG,CAACG,QAAQ,IAAIH,GAAG,CAACG,QAAQ,CAACC,MAAM,GAAG,CAAC,EAAE;QAC3CN,GAAG,CAACO,IAAI,CAACL,GAAG,CAAC;MACf;IACF,CAAC,MAAM;MACL,IAAIX,aAAa,CAACC,KAAK,EAAEU,GAAG,CAAC,EAAE;QAC7BF,GAAG,CAACO,IAAI,CAACL,GAAG,CAAC;MACf;IACF;EACF,CAAC,CAAC;EAEF,OAAOF,GAAG;AACZ;AAEA,IAAMQ,UAAU,GAAG;EACjBC,KAAK,EAAE;IACLC,OAAO,EAAEC,yBAAiB;IAC1BC,UAAU,EAAE;EACd,CAAC;EACDC,SAAS,EAAE;IACTC,WAAW,EAAE,SAAAA,YAACL,KAAK,EAAEC,OAAO,EAAK;MAC/BD,KAAK,CAACG,UAAU,GAAGF,OAAO;MAC1BD,KAAK,CAACC,OAAO,GAAGC,yBAAiB,CAACI,MAAM,CAACL,OAAO,CAAC;IACnD;EACF,CAAC;EACDM,OAAO,EAAE;IACPC,cAAc,WAAAA,eAAAC,IAAA,EAAaC,IAAI,EAAE;MAAA,IAAhBC,MAAM,GAAAF,IAAA,CAANE,MAAM;MACrB,OAAO,IAAIC,OAAO,CAAC,UAAAC,OAAO,EAAI;QAC5B,IAAQ9B,KAAK,GAAK2B,IAAI,CAAd3B,KAAK;QACb,IAAI+B,eAAe;QACnB,IAAI/B,KAAK,CAACK,QAAQ,CAAC,GAAG,CAAC,EAAE;UACvB0B,eAAe,GAAGC,sBAAc;QAClC,CAAC,MAAM;UACLD,eAAe,GAAGzB,iBAAiB,CAAC0B,sBAAc,EAAEhC,KAAK,CAAC;QAC5D;QACA4B,MAAM,CAAC,aAAa,EAAEG,eAAe,CAAC;QACtCD,OAAO,CAAC,CAAC;MACX,CAAC,CAAC;IACJ;EACF;AACF,CAAC;AAAA,IAAAG,QAAA,GAAAC,OAAA,CAAAtB,OAAA,GAEcI,UAAU","ignoreList":[]}]}