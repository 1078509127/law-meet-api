{"remainingRequest":"D:\\Projects\\java\\dts-shop-api\\admin-ui\\node_modules\\@vue\\cli-plugin-babel\\node_modules\\babel-loader\\lib\\index.js!D:\\Projects\\java\\dts-shop-api\\admin-ui\\node_modules\\cache-loader\\dist\\cjs.js??ref--0-0!D:\\Projects\\java\\dts-shop-api\\admin-ui\\node_modules\\vue-loader\\lib\\index.js??vue-loader-options!D:\\Projects\\java\\dts-shop-api\\admin-ui\\src\\views\\sys\\role.vue?vue&type=script&lang=js","dependencies":[{"path":"D:\\Projects\\java\\dts-shop-api\\admin-ui\\src\\views\\sys\\role.vue","mtime":1720695645781},{"path":"D:\\Projects\\java\\dts-shop-api\\admin-ui\\babel.config.js","mtime":1720695645901},{"path":"D:\\Projects\\java\\dts-shop-api\\admin-ui\\node_modules\\cache-loader\\dist\\cjs.js","mtime":1720774706922},{"path":"D:\\Projects\\java\\dts-shop-api\\admin-ui\\node_modules\\@vue\\cli-plugin-babel\\node_modules\\babel-loader\\lib\\index.js","mtime":1720774708117},{"path":"D:\\Projects\\java\\dts-shop-api\\admin-ui\\node_modules\\cache-loader\\dist\\cjs.js","mtime":1720774706922},{"path":"D:\\Projects\\java\\dts-shop-api\\admin-ui\\node_modules\\vue-loader\\lib\\index.js","mtime":1720774708700}],"contextDependencies":[],"result":[{"type":"Buffer","data":"base64:InVzZSBzdHJpY3QiOwoKdmFyIF9pbnRlcm9wUmVxdWlyZURlZmF1bHQgPSByZXF1aXJlKCJEOi9Qcm9qZWN0cy9qYXZhL2R0cy1zaG9wLWFwaS9hZG1pbi11aS9ub2RlX21vZHVsZXMvQGJhYmVsL3J1bnRpbWUvaGVscGVycy9pbnRlcm9wUmVxdWlyZURlZmF1bHQuanMiKS5kZWZhdWx0OwpPYmplY3QuZGVmaW5lUHJvcGVydHkoZXhwb3J0cywgIl9fZXNNb2R1bGUiLCB7CiAgdmFsdWU6IHRydWUKfSk7CmV4cG9ydHMuZGVmYXVsdCA9IHZvaWQgMDsKcmVxdWlyZSgiY29yZS1qcy9tb2R1bGVzL2VzLmFycmF5LnNwbGljZS5qcyIpOwp2YXIgX2NyZWF0ZUZvck9mSXRlcmF0b3JIZWxwZXIyID0gX2ludGVyb3BSZXF1aXJlRGVmYXVsdChyZXF1aXJlKCJEOi9Qcm9qZWN0cy9qYXZhL2R0cy1zaG9wLWFwaS9hZG1pbi11aS9ub2RlX21vZHVsZXMvQGJhYmVsL3J1bnRpbWUvaGVscGVycy9jcmVhdGVGb3JPZkl0ZXJhdG9ySGVscGVyLmpzIikpOwp2YXIgX3JvbGUgPSByZXF1aXJlKCJAL2FwaS9idXNpbmVzcy9yb2xlIik7CnZhciBfUGFnaW5hdGlvbiA9IF9pbnRlcm9wUmVxdWlyZURlZmF1bHQocmVxdWlyZSgiQC9jb21wb25lbnRzL1BhZ2luYXRpb24iKSk7Ci8vCi8vCi8vCi8vCi8vCi8vCi8vCi8vCi8vCi8vCi8vCi8vCi8vCi8vCi8vCi8vCi8vCi8vCi8vCi8vCi8vCi8vCi8vCi8vCi8vCi8vCi8vCi8vCi8vCi8vCi8vCi8vCi8vCi8vCi8vCi8vCi8vCi8vCi8vCi8vCi8vCi8vCi8vCi8vCi8vCi8vCi8vCi8vCi8vCi8vCi8vCi8vCi8vCi8vCi8vCi8vCi8vCi8vCi8vCi8vCi8vCi8vCi8vCi8vCi8vCi8vCi8vCnZhciBfZGVmYXVsdCA9IGV4cG9ydHMuZGVmYXVsdCA9IHsKICBuYW1lOiAnUm9sZScsCiAgY29tcG9uZW50czogewogICAgUGFnaW5hdGlvbjogX1BhZ2luYXRpb24uZGVmYXVsdAogIH0sCiAgZGF0YTogZnVuY3Rpb24gZGF0YSgpIHsKICAgIHJldHVybiB7CiAgICAgIGxpc3Q6IG51bGwsCiAgICAgIHRvdGFsOiAwLAogICAgICBsaXN0TG9hZGluZzogdHJ1ZSwKICAgICAgbGlzdFF1ZXJ5OiB7CiAgICAgICAgcGFnZTogMSwKICAgICAgICBsaW1pdDogMjAsCiAgICAgICAgbmFtZTogdW5kZWZpbmVkLAogICAgICAgIHNvcnQ6ICdhZGRfdGltZScsCiAgICAgICAgb3JkZXI6ICdkZXNjJwogICAgICB9LAogICAgICBkYXRhRm9ybTogewogICAgICAgIGlkOiB1bmRlZmluZWQsCiAgICAgICAgbmFtZTogdW5kZWZpbmVkLAogICAgICAgIGRlc2M6IHVuZGVmaW5lZAogICAgICB9LAogICAgICBkaWFsb2dGb3JtVmlzaWJsZTogZmFsc2UsCiAgICAgIGRpYWxvZ1N0YXR1czogJycsCiAgICAgIHRleHRNYXA6IHsKICAgICAgICB1cGRhdGU6ICfnvJbovpEnLAogICAgICAgIGNyZWF0ZTogJ+WIm+W7uicKICAgICAgfSwKICAgICAgcnVsZXM6IHsKICAgICAgICBuYW1lOiBbewogICAgICAgICAgcmVxdWlyZWQ6IHRydWUsCiAgICAgICAgICBtZXNzYWdlOiAn6KeS6Imy5ZCN56ew5LiN6IO95Li656m6JywKICAgICAgICAgIHRyaWdnZXI6ICdibHVyJwogICAgICAgIH1dCiAgICAgIH0sCiAgICAgIHBlcm1pc3Npb25EaWFsb2dGb3JtVmlzaWJsZTogZmFsc2UsCiAgICAgIHN5c3RlbVBlcm1pc3Npb25zOiBudWxsLAogICAgICBhc3NpZ25lZFBlcm1pc3Npb25zOiBudWxsLAogICAgICBwZXJtaXNzaW9uRm9ybTogewogICAgICAgIHJvbGVJZDogdW5kZWZpbmVkLAogICAgICAgIHBlcm1pc3Npb25zOiBbXQogICAgICB9CiAgICB9OwogIH0sCiAgY3JlYXRlZDogZnVuY3Rpb24gY3JlYXRlZCgpIHsKICAgIHRoaXMuZ2V0TGlzdCgpOwogIH0sCiAgbWV0aG9kczogewogICAgZ2V0TGlzdDogZnVuY3Rpb24gZ2V0TGlzdCgpIHsKICAgICAgdmFyIF90aGlzID0gdGhpczsKICAgICAgdGhpcy5saXN0TG9hZGluZyA9IHRydWU7CiAgICAgICgwLCBfcm9sZS5saXN0Um9sZSkodGhpcy5saXN0UXVlcnkpLnRoZW4oZnVuY3Rpb24gKHJlc3BvbnNlKSB7CiAgICAgICAgX3RoaXMubGlzdCA9IHJlc3BvbnNlLmRhdGEuZGF0YS5pdGVtczsKICAgICAgICBfdGhpcy50b3RhbCA9IHJlc3BvbnNlLmRhdGEuZGF0YS50b3RhbDsKICAgICAgICBfdGhpcy5saXN0TG9hZGluZyA9IGZhbHNlOwogICAgICB9KS5jYXRjaChmdW5jdGlvbiAoKSB7CiAgICAgICAgX3RoaXMubGlzdCA9IFtdOwogICAgICAgIF90aGlzLnRvdGFsID0gMDsKICAgICAgICBfdGhpcy5saXN0TG9hZGluZyA9IGZhbHNlOwogICAgICB9KTsKICAgIH0sCiAgICBoYW5kbGVGaWx0ZXI6IGZ1bmN0aW9uIGhhbmRsZUZpbHRlcigpIHsKICAgICAgdGhpcy5saXN0UXVlcnkucGFnZSA9IDE7CiAgICAgIHRoaXMuZ2V0TGlzdCgpOwogICAgfSwKICAgIHJlc2V0Rm9ybTogZnVuY3Rpb24gcmVzZXRGb3JtKCkgewogICAgICB0aGlzLmRhdGFGb3JtID0gewogICAgICAgIGlkOiB1bmRlZmluZWQsCiAgICAgICAgbmFtZTogdW5kZWZpbmVkLAogICAgICAgIGRlc2M6IHVuZGVmaW5lZAogICAgICB9OwogICAgfSwKICAgIGhhbmRsZUNyZWF0ZTogZnVuY3Rpb24gaGFuZGxlQ3JlYXRlKCkgewogICAgICB2YXIgX3RoaXMyID0gdGhpczsKICAgICAgdGhpcy5yZXNldEZvcm0oKTsKICAgICAgdGhpcy5kaWFsb2dTdGF0dXMgPSAnY3JlYXRlJzsKICAgICAgdGhpcy5kaWFsb2dGb3JtVmlzaWJsZSA9IHRydWU7CiAgICAgIHRoaXMuJG5leHRUaWNrKGZ1bmN0aW9uICgpIHsKICAgICAgICBfdGhpczIuJHJlZnNbJ2RhdGFGb3JtJ10uY2xlYXJWYWxpZGF0ZSgpOwogICAgICB9KTsKICAgIH0sCiAgICBjcmVhdGVEYXRhOiBmdW5jdGlvbiBjcmVhdGVEYXRhKCkgewogICAgICB2YXIgX3RoaXMzID0gdGhpczsKICAgICAgdGhpcy4kcmVmc1snZGF0YUZvcm0nXS52YWxpZGF0ZShmdW5jdGlvbiAodmFsaWQpIHsKICAgICAgICBpZiAodmFsaWQpIHsKICAgICAgICAgICgwLCBfcm9sZS5jcmVhdGVSb2xlKShfdGhpczMuZGF0YUZvcm0pLnRoZW4oZnVuY3Rpb24gKHJlc3BvbnNlKSB7CiAgICAgICAgICAgIF90aGlzMy5saXN0LnVuc2hpZnQocmVzcG9uc2UuZGF0YS5kYXRhKTsKICAgICAgICAgICAgX3RoaXMzLmRpYWxvZ0Zvcm1WaXNpYmxlID0gZmFsc2U7CiAgICAgICAgICAgIF90aGlzMy4kbm90aWZ5LnN1Y2Nlc3MoewogICAgICAgICAgICAgIHRpdGxlOiAn5oiQ5YqfJywKICAgICAgICAgICAgICBtZXNzYWdlOiAn5re75Yqg6KeS6Imy5oiQ5YqfJwogICAgICAgICAgICB9KTsKICAgICAgICAgIH0pLmNhdGNoKGZ1bmN0aW9uIChyZXNwb25zZSkgewogICAgICAgICAgICBfdGhpczMuJG5vdGlmeS5lcnJvcih7CiAgICAgICAgICAgICAgdGl0bGU6ICflpLHotKUnLAogICAgICAgICAgICAgIG1lc3NhZ2U6IHJlc3BvbnNlLmRhdGEuZXJybXNnCiAgICAgICAgICAgIH0pOwogICAgICAgICAgfSk7CiAgICAgICAgfQogICAgICB9KTsKICAgIH0sCiAgICBoYW5kbGVVcGRhdGU6IGZ1bmN0aW9uIGhhbmRsZVVwZGF0ZShyb3cpIHsKICAgICAgdmFyIF90aGlzNCA9IHRoaXM7CiAgICAgIHRoaXMuZGF0YUZvcm0gPSBPYmplY3QuYXNzaWduKHt9LCByb3cpOwogICAgICB0aGlzLmRpYWxvZ1N0YXR1cyA9ICd1cGRhdGUnOwogICAgICB0aGlzLmRpYWxvZ0Zvcm1WaXNpYmxlID0gdHJ1ZTsKICAgICAgdGhpcy4kbmV4dFRpY2soZnVuY3Rpb24gKCkgewogICAgICAgIF90aGlzNC4kcmVmc1snZGF0YUZvcm0nXS5jbGVhclZhbGlkYXRlKCk7CiAgICAgIH0pOwogICAgfSwKICAgIHVwZGF0ZURhdGE6IGZ1bmN0aW9uIHVwZGF0ZURhdGEoKSB7CiAgICAgIHZhciBfdGhpczUgPSB0aGlzOwogICAgICB0aGlzLiRyZWZzWydkYXRhRm9ybSddLnZhbGlkYXRlKGZ1bmN0aW9uICh2YWxpZCkgewogICAgICAgIGlmICh2YWxpZCkgewogICAgICAgICAgKDAsIF9yb2xlLnVwZGF0ZVJvbGUpKF90aGlzNS5kYXRhRm9ybSkudGhlbihmdW5jdGlvbiAoKSB7CiAgICAgICAgICAgIHZhciBfaXRlcmF0b3IgPSAoMCwgX2NyZWF0ZUZvck9mSXRlcmF0b3JIZWxwZXIyLmRlZmF1bHQpKF90aGlzNS5saXN0KSwKICAgICAgICAgICAgICBfc3RlcDsKICAgICAgICAgICAgdHJ5IHsKICAgICAgICAgICAgICBmb3IgKF9pdGVyYXRvci5zKCk7ICEoX3N0ZXAgPSBfaXRlcmF0b3IubigpKS5kb25lOykgewogICAgICAgICAgICAgICAgdmFyIHYgPSBfc3RlcC52YWx1ZTsKICAgICAgICAgICAgICAgIGlmICh2LmlkID09PSBfdGhpczUuZGF0YUZvcm0uaWQpIHsKICAgICAgICAgICAgICAgICAgdmFyIGluZGV4ID0gX3RoaXM1Lmxpc3QuaW5kZXhPZih2KTsKICAgICAgICAgICAgICAgICAgX3RoaXM1Lmxpc3Quc3BsaWNlKGluZGV4LCAxLCBfdGhpczUuZGF0YUZvcm0pOwogICAgICAgICAgICAgICAgICBicmVhazsKICAgICAgICAgICAgICAgIH0KICAgICAgICAgICAgICB9CiAgICAgICAgICAgIH0gY2F0Y2ggKGVycikgewogICAgICAgICAgICAgIF9pdGVyYXRvci5lKGVycik7CiAgICAgICAgICAgIH0gZmluYWxseSB7CiAgICAgICAgICAgICAgX2l0ZXJhdG9yLmYoKTsKICAgICAgICAgICAgfQogICAgICAgICAgICBfdGhpczUuZGlhbG9nRm9ybVZpc2libGUgPSBmYWxzZTsKICAgICAgICAgICAgX3RoaXM1LiRub3RpZnkuc3VjY2Vzcyh7CiAgICAgICAgICAgICAgdGl0bGU6ICfmiJDlip8nLAogICAgICAgICAgICAgIG1lc3NhZ2U6ICfmm7TmlrDnrqHnkIblkZjmiJDlip8nCiAgICAgICAgICAgIH0pOwogICAgICAgICAgfSkuY2F0Y2goZnVuY3Rpb24gKHJlc3BvbnNlKSB7CiAgICAgICAgICAgIF90aGlzNS4kbm90aWZ5LmVycm9yKHsKICAgICAgICAgICAgICB0aXRsZTogJ+Wksei0pScsCiAgICAgICAgICAgICAgbWVzc2FnZTogcmVzcG9uc2UuZGF0YS5lcnJtc2cKICAgICAgICAgICAgfSk7CiAgICAgICAgICB9KTsKICAgICAgICB9CiAgICAgIH0pOwogICAgfSwKICAgIGhhbmRsZURlbGV0ZTogZnVuY3Rpb24gaGFuZGxlRGVsZXRlKHJvdykgewogICAgICB2YXIgX3RoaXM2ID0gdGhpczsKICAgICAgKDAsIF9yb2xlLmRlbGV0ZVJvbGUpKHJvdykudGhlbihmdW5jdGlvbiAocmVzcG9uc2UpIHsKICAgICAgICBfdGhpczYuJG5vdGlmeS5zdWNjZXNzKHsKICAgICAgICAgIHRpdGxlOiAn5oiQ5YqfJywKICAgICAgICAgIG1lc3NhZ2U6ICfliKDpmaTnrqHnkIblkZjmiJDlip8nCiAgICAgICAgfSk7CiAgICAgICAgdmFyIGluZGV4ID0gX3RoaXM2Lmxpc3QuaW5kZXhPZihyb3cpOwogICAgICAgIF90aGlzNi5saXN0LnNwbGljZShpbmRleCwgMSk7CiAgICAgIH0pLmNhdGNoKGZ1bmN0aW9uIChyZXNwb25zZSkgewogICAgICAgIF90aGlzNi4kbm90aWZ5LmVycm9yKHsKICAgICAgICAgIHRpdGxlOiAn5aSx6LSlJywKICAgICAgICAgIG1lc3NhZ2U6IHJlc3BvbnNlLmRhdGEuZXJybXNnCiAgICAgICAgfSk7CiAgICAgIH0pOwogICAgfSwKICAgIGhhbmRsZVBlcm1pc3Npb246IGZ1bmN0aW9uIGhhbmRsZVBlcm1pc3Npb24ocm93KSB7CiAgICAgIHZhciBfdGhpczcgPSB0aGlzOwogICAgICB0aGlzLnBlcm1pc3Npb25EaWFsb2dGb3JtVmlzaWJsZSA9IHRydWU7CiAgICAgIHRoaXMucGVybWlzc2lvbkZvcm0ucm9sZUlkID0gcm93LmlkOwogICAgICAoMCwgX3JvbGUuZ2V0UGVybWlzc2lvbikoewogICAgICAgIHJvbGVJZDogcm93LmlkCiAgICAgIH0pLnRoZW4oZnVuY3Rpb24gKHJlc3BvbnNlKSB7CiAgICAgICAgX3RoaXM3LnN5c3RlbVBlcm1pc3Npb25zID0gcmVzcG9uc2UuZGF0YS5kYXRhLnN5c3RlbVBlcm1pc3Npb25zOwogICAgICAgIF90aGlzNy5hc3NpZ25lZFBlcm1pc3Npb25zID0gcmVzcG9uc2UuZGF0YS5kYXRhLmFzc2lnbmVkUGVybWlzc2lvbnM7CiAgICAgIH0pOwogICAgfSwKICAgIHVwZGF0ZVBlcm1pc3Npb246IGZ1bmN0aW9uIHVwZGF0ZVBlcm1pc3Npb24oKSB7CiAgICAgIHZhciBfdGhpczggPSB0aGlzOwogICAgICB0aGlzLnBlcm1pc3Npb25Gb3JtLnBlcm1pc3Npb25zID0gdGhpcy4kcmVmcy50cmVlLmdldENoZWNrZWRLZXlzKHRydWUpOwogICAgICAoMCwgX3JvbGUudXBkYXRlUGVybWlzc2lvbikodGhpcy5wZXJtaXNzaW9uRm9ybSkudGhlbihmdW5jdGlvbiAocmVzcG9uc2UpIHsKICAgICAgICBfdGhpczgucGVybWlzc2lvbkRpYWxvZ0Zvcm1WaXNpYmxlID0gZmFsc2U7CiAgICAgICAgX3RoaXM4LiRub3RpZnkuc3VjY2Vzcyh7CiAgICAgICAgICB0aXRsZTogJ+aIkOWKnycsCiAgICAgICAgICBtZXNzYWdlOiAn5o6I5p2D5oiQ5YqfJwogICAgICAgIH0pOwogICAgICB9KS5jYXRjaChmdW5jdGlvbiAocmVzcG9uc2UpIHsKICAgICAgICBfdGhpczguJG5vdGlmeS5lcnJvcih7CiAgICAgICAgICB0aXRsZTogJ+Wksei0pScsCiAgICAgICAgICBtZXNzYWdlOiByZXNwb25zZS5kYXRhLmVycm1zZwogICAgICAgIH0pOwogICAgICB9KTsKICAgIH0KICB9Cn07"},{"version":3,"names":["_role","require","_Pagination","_interopRequireDefault","name","components","Pagination","data","list","total","listLoading","listQuery","page","limit","undefined","sort","order","dataForm","id","desc","dialogFormVisible","dialogStatus","textMap","update","create","rules","required","message","trigger","permissionDialogFormVisible","systemPermissions","assignedPermissions","permissionForm","roleId","permissions","created","getList","methods","_this","listRole","then","response","items","catch","handleFilter","resetForm","handleCreate","_this2","$nextTick","$refs","clearValidate","createData","_this3","validate","valid","createRole","unshift","$notify","success","title","error","errmsg","handleUpdate","row","_this4","Object","assign","updateData","_this5","updateRole","_iterator","_createForOfIteratorHelper2","default","_step","s","n","done","v","value","index","indexOf","splice","err","e","f","handleDelete","_this6","deleteRole","handlePermission","_this7","getPermission","updatePermission","_this8","tree","getCheckedKeys"],"sources":["src/views/sys/role.vue"],"sourcesContent":["<template>\r\n  <div class=\"app-container\">\r\n\r\n    <!-- 查询和其他操作 -->\r\n    <div class=\"filter-container\">\r\n      <el-input v-model=\"listQuery.rolename\" clearable size=\"mini\" class=\"filter-item\" style=\"width: 200px;\" placeholder=\"请输入角色名称\"/>\r\n      <el-button v-permission=\"['GET /admin/role/list']\" size=\"mini\" class=\"filter-item\" type=\"primary\" icon=\"el-icon-search\" @click=\"handleFilter\">查找</el-button>\r\n      <el-button v-permission=\"['POST /admin/role/create']\" size=\"mini\" class=\"filter-item\" type=\"primary\" icon=\"el-icon-edit\" @click=\"handleCreate\">添加</el-button>\r\n    </div>\r\n\r\n    <!-- 查询结果 -->\r\n    <el-table v-loading=\"listLoading\" :data=\"list\" size=\"small\" element-loading-text=\"正在查询中。。。\" border fit highlight-current-row>\r\n      <el-table-column align=\"center\" label=\"角色名称\" prop=\"name\" sortable/>\r\n\r\n      <el-table-column align=\"center\" label=\"说明\" prop=\"desc\"/>\r\n\r\n      <el-table-column align=\"center\" label=\"操作\" class-name=\"small-padding fixed-width\">\r\n        <template slot-scope=\"scope\">\r\n          <el-button v-permission=\"['POST /admin/role/update']\" type=\"primary\" size=\"mini\" @click=\"handleUpdate(scope.row)\">编辑</el-button>\r\n          <el-button v-permission=\"['POST /admin/role/delete']\" type=\"danger\" size=\"mini\" @click=\"handleDelete(scope.row)\">删除</el-button>\r\n          <el-button v-permission=\"['GET /admin/role/permissions']\" type=\"primary\" size=\"mini\" @click=\"handlePermission(scope.row)\">授权</el-button>\r\n        </template>\r\n      </el-table-column>\r\n    </el-table>\r\n\r\n    <pagination v-show=\"total>0\" :total=\"total\" :page.sync=\"listQuery.page\" :limit.sync=\"listQuery.limit\" @pagination=\"getList\" />\r\n\r\n    <!-- 添加或修改对话框 -->\r\n    <el-dialog :title=\"textMap[dialogStatus]\" :visible.sync=\"dialogFormVisible\">\r\n      <el-form ref=\"dataForm\" :rules=\"rules\" :model=\"dataForm\" status-icon label-position=\"left\" label-width=\"100px\" style=\"width: 400px; margin-left:50px;\">\r\n        <el-form-item label=\"角色名称\" prop=\"name\">\r\n          <el-input v-model=\"dataForm.name\"/>\r\n        </el-form-item>\r\n        <el-form-item label=\"说明\" prop=\"desc\">\r\n          <el-input v-model=\"dataForm.desc\"/>\r\n        </el-form-item>\r\n      </el-form>\r\n      <div slot=\"footer\" class=\"dialog-footer\">\r\n        <el-button @click=\"dialogFormVisible = false\">取消</el-button>\r\n        <el-button v-if=\"dialogStatus=='create'\" type=\"primary\" @click=\"createData\">确定</el-button>\r\n        <el-button v-else type=\"primary\" @click=\"updateData\">确定</el-button>\r\n      </div>\r\n    </el-dialog>\r\n\r\n    <!-- 权限配置对话框 -->\r\n    <el-dialog :visible.sync=\"permissionDialogFormVisible\" title=\"权限配置\">\r\n      <el-tree\r\n        ref=\"tree\"\r\n        :data=\"systemPermissions\"\r\n        :default-checked-keys=\"assignedPermissions\"\r\n        show-checkbox\r\n        node-key=\"id\"\r\n        highlight-current>\r\n        <span slot-scope=\"{ node, data }\" class=\"custom-tree-node\">\r\n          <span>{{ data.label }}</span>\r\n          <el-tag v-if=\"data.api\" type=\"success\" size=\"mini\">{{ data.api }}</el-tag>\r\n        </span>\r\n      </el-tree>\r\n      <div slot=\"footer\" class=\"dialog-footer\">\r\n        <el-button @click=\"permissionDialogFormVisible = false\">取消</el-button>\r\n        <el-button type=\"primary\" @click=\"updatePermission\">确定</el-button>\r\n      </div>\r\n    </el-dialog>\r\n\r\n  </div>\r\n</template>\r\n\r\n<script>\r\nimport { listRole, createRole, updateRole, deleteRole, getPermission, updatePermission } from '@/api/business/role'\r\nimport Pagination from '@/components/Pagination'\r\nexport default {\r\n  name: 'Role',\r\n  components: { Pagination },\r\n  data() {\r\n    return {\r\n      list: null,\r\n      total: 0,\r\n      listLoading: true,\r\n      listQuery: {\r\n        page: 1,\r\n        limit: 20,\r\n        name: undefined,\r\n        sort: 'add_time',\r\n        order: 'desc'\r\n      },\r\n      dataForm: {\r\n        id: undefined,\r\n        name: undefined,\r\n        desc: undefined\r\n      },\r\n      dialogFormVisible: false,\r\n      dialogStatus: '',\r\n      textMap: {\r\n        update: '编辑',\r\n        create: '创建'\r\n      },\r\n      rules: {\r\n        name: [\r\n          { required: true, message: '角色名称不能为空', trigger: 'blur' }\r\n        ]\r\n      },\r\n      permissionDialogFormVisible: false,\r\n      systemPermissions: null,\r\n      assignedPermissions: null,\r\n      permissionForm: {\r\n        roleId: undefined,\r\n        permissions: []\r\n      }\r\n    }\r\n  },\r\n  created() {\r\n    this.getList()\r\n  },\r\n  methods: {\r\n    getList() {\r\n      this.listLoading = true\r\n      listRole(this.listQuery)\r\n        .then(response => {\r\n          this.list = response.data.data.items\r\n          this.total = response.data.data.total\r\n          this.listLoading = false\r\n        })\r\n        .catch(() => {\r\n          this.list = []\r\n          this.total = 0\r\n          this.listLoading = false\r\n        })\r\n    },\r\n    handleFilter() {\r\n      this.listQuery.page = 1\r\n      this.getList()\r\n    },\r\n    resetForm() {\r\n      this.dataForm = {\r\n        id: undefined,\r\n        name: undefined,\r\n        desc: undefined\r\n      }\r\n    },\r\n    handleCreate() {\r\n      this.resetForm()\r\n      this.dialogStatus = 'create'\r\n      this.dialogFormVisible = true\r\n      this.$nextTick(() => {\r\n        this.$refs['dataForm'].clearValidate()\r\n      })\r\n    },\r\n    createData() {\r\n      this.$refs['dataForm'].validate(valid => {\r\n        if (valid) {\r\n          createRole(this.dataForm)\r\n            .then(response => {\r\n              this.list.unshift(response.data.data)\r\n              this.dialogFormVisible = false\r\n              this.$notify.success({\r\n                title: '成功',\r\n                message: '添加角色成功'\r\n              })\r\n            })\r\n            .catch(response => {\r\n              this.$notify.error({\r\n                title: '失败',\r\n                message: response.data.errmsg\r\n              })\r\n            })\r\n        }\r\n      })\r\n    },\r\n    handleUpdate(row) {\r\n      this.dataForm = Object.assign({}, row)\r\n      this.dialogStatus = 'update'\r\n      this.dialogFormVisible = true\r\n      this.$nextTick(() => {\r\n        this.$refs['dataForm'].clearValidate()\r\n      })\r\n    },\r\n    updateData() {\r\n      this.$refs['dataForm'].validate(valid => {\r\n        if (valid) {\r\n          updateRole(this.dataForm)\r\n            .then(() => {\r\n              for (const v of this.list) {\r\n                if (v.id === this.dataForm.id) {\r\n                  const index = this.list.indexOf(v)\r\n                  this.list.splice(index, 1, this.dataForm)\r\n                  break\r\n                }\r\n              }\r\n              this.dialogFormVisible = false\r\n              this.$notify.success({\r\n                title: '成功',\r\n                message: '更新管理员成功'\r\n              })\r\n            })\r\n            .catch(response => {\r\n              this.$notify.error({\r\n                title: '失败',\r\n                message: response.data.errmsg\r\n              })\r\n            })\r\n        }\r\n      })\r\n    },\r\n    handleDelete(row) {\r\n      deleteRole(row)\r\n        .then(response => {\r\n          this.$notify.success({\r\n            title: '成功',\r\n            message: '删除管理员成功'\r\n          })\r\n          const index = this.list.indexOf(row)\r\n          this.list.splice(index, 1)\r\n        })\r\n        .catch(response => {\r\n          this.$notify.error({\r\n            title: '失败',\r\n            message: response.data.errmsg\r\n          })\r\n        })\r\n    },\r\n    handlePermission(row) {\r\n      this.permissionDialogFormVisible = true\r\n      this.permissionForm.roleId = row.id\r\n      getPermission({ roleId: row.id })\r\n        .then(response => {\r\n          this.systemPermissions = response.data.data.systemPermissions\r\n          this.assignedPermissions = response.data.data.assignedPermissions\r\n        })\r\n    },\r\n    updatePermission() {\r\n      this.permissionForm.permissions = this.$refs.tree.getCheckedKeys(true)\r\n      updatePermission(this.permissionForm)\r\n        .then(response => {\r\n          this.permissionDialogFormVisible = false\r\n          this.$notify.success({\r\n            title: '成功',\r\n            message: '授权成功'\r\n          })\r\n        })\r\n        .catch(response => {\r\n          this.$notify.error({\r\n            title: '失败',\r\n            message: response.data.errmsg\r\n          })\r\n        })\r\n    }\r\n  }\r\n}\r\n</script>\r\n"],"mappings":"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","ignoreList":[]}]}